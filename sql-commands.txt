create table author(
	id uuid not null primary key,
	name varchar(100) not null,
	birth_date date not null,
	nationality varchar(50) not null,
    registration_date timestamp,
    update_date timestamp,
    user_id uuid
);

create table book(
	id uuid not null primary key,
	isbn varchar(20) not null unique,
	title varchar(150) not null,
	publication_date date not null,
	genre varchar(30) not null,
	price numeric(18,2),
	registration_date timestamp,
    update_date timestamp,
    user_id uuid,
	author_id uuid not null references author(id),
	constraint chk_genre check (genre in ('FICTION', 'FANTASY', 'MISTERY', 'ROMANCE', 'BIOGRAPHY', 'SCIENCE'))
);

create table users(
    id uuid not null primary key,
    login varchar(20) not null unique,
    password varchar(300) not null,
	email varchar(150) not null,
    roles varchar[]
);

create table client(
	id uuid not null primary key,
	client_id varchar(150) not null,
	client_secret varchar(400) not null,
	redirect_uri varchar(200) not null,
	scope varchar(50)
);

CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

insert into users
(id, login, password, email, roles)
values
(uuid_generate_v4(), 'manager',
'$2a$12$JfIjtIQYAeuAgYJ590yjqeDNrLAkIRM6t45GUca2n8.jkkGkwVb/2',
'manager@gmail.com', '{MANAGER}');

insert into client
(id, client_id, client_secret, redirect_uri, scope)
values
(uuid_generate_v4(), 'production-client',
'$2a$12$TxJqlXs6CMuOZEL9QS2AOuQdKDFL/.z6J/VAkiF79jLt7g7u49cvG',
'http://localhost:8080/authorized', '{MANAGER}');
